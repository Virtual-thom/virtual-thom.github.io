<!DOCTYPE html>
<html lang="fr">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="apple-touch-icon" href="https://virtual-thom.github.io/archives/apple-touch-icon.png">
  <link rel="icon" href="https://virtual-thom.github.io/archives/favicon.ico" />
  <!-- Remplac√© par Jekyll SEO (sinon apparait en double)
  <title>VTOM Cas d'√©cole n¬∞2</title>
  <meta name="description" content="Contexte et souhait du client (d√©sol√© je ne les invente pas ü§ê) :  3 applications A, B, C, cycliques 5 min (cha√Ænes de jobs plut√¥t complexes √† l‚Äôint√©rieur, on...">
  --> 
  
  <link rel="canonical" href="https://virtual-thom.github.io/archives/vtom-cas-ecole-2/">
  
  <link rel="stylesheet" media="screen" href="https://virtual-thom.github.io/archives/assets/main.css">
  
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>VTOM Cas d‚Äô√©cole n¬∞2 | Virtual-Thom Blog-notes VTOM et informatique</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="VTOM Cas d‚Äô√©cole n¬∞2" />
<meta name="author" content="Virtual Thom" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Contexte et souhait du client (d√©sol√© je ne les invente pas ü§ê) : 3 applications A, B, C, cycliques 5 min (cha√Ænes de jobs plut√¥t complexes √† l‚Äôint√©rieur, on verra que √ßa excluera une des possibilit√©s) l‚Äôapplication C ne doit pas tourner si A ou B est en cours A de 6h √† 23h B de 18h √† 23h C de 6h √† 23h on part du principe que les cycles s‚Äôenchainent correctement et qu‚Äôune fois C en cours, peut importe le comportement de A ou de B" />
<meta property="og:description" content="Contexte et souhait du client (d√©sol√© je ne les invente pas ü§ê) : 3 applications A, B, C, cycliques 5 min (cha√Ænes de jobs plut√¥t complexes √† l‚Äôint√©rieur, on verra que √ßa excluera une des possibilit√©s) l‚Äôapplication C ne doit pas tourner si A ou B est en cours A de 6h √† 23h B de 18h √† 23h C de 6h √† 23h on part du principe que les cycles s‚Äôenchainent correctement et qu‚Äôune fois C en cours, peut importe le comportement de A ou de B" />
<link rel="canonical" href="https://virtual-thom.github.io/archives/vtom-cas-ecole-2/" />
<meta property="og:url" content="https://virtual-thom.github.io/archives/vtom-cas-ecole-2/" />
<meta property="og:site_name" content="Virtual-Thom Blog-notes VTOM et informatique" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-01-11T18:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="VTOM Cas d‚Äô√©cole n¬∞2" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Virtual Thom"},"dateModified":"2023-01-11T18:00:00+00:00","datePublished":"2023-01-11T18:00:00+00:00","description":"Contexte et souhait du client (d√©sol√© je ne les invente pas ü§ê) : 3 applications A, B, C, cycliques 5 min (cha√Ænes de jobs plut√¥t complexes √† l‚Äôint√©rieur, on verra que √ßa excluera une des possibilit√©s) l‚Äôapplication C ne doit pas tourner si A ou B est en cours A de 6h √† 23h B de 18h √† 23h C de 6h √† 23h on part du principe que les cycles s‚Äôenchainent correctement et qu‚Äôune fois C en cours, peut importe le comportement de A ou de B","headline":"VTOM Cas d‚Äô√©cole n¬∞2","mainEntityOfPage":{"@type":"WebPage","@id":"https://virtual-thom.github.io/archives/vtom-cas-ecole-2/"},"url":"https://virtual-thom.github.io/archives/vtom-cas-ecole-2/"}</script>
<!-- End Jekyll SEO tag -->

  
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Z8Y7902GRV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Z8Y7902GRV');
</script>


  <body>
    <div class="container">
      <header id="site-header">
  <h1>Blog-notes VTOM, informatique, industrialisation, ordonnancement, DevOps</h1>
  <nav>
    <ul>
      <li>
        <a href="https://virtual-thom.github.io/archives" title="Home">
          <svg class="svg-icon" viewBox="0 0 20 20">
            <path d="M18.121,9.88l-7.832-7.836c-0.155-0.158-0.428-0.155-0.584,0L1.842,9.913c-0.262,0.263-0.073,0.705,0.292,0.705h2.069v7.042c0,0.227,0.187,0.414,0.414,0.414h3.725c0.228,0,0.414-0.188,0.414-0.414v-3.313h2.483v3.313c0,0.227,0.187,0.414,0.413,0.414h3.726c0.229,0,0.414-0.188,0.414-0.414v-7.042h2.068h0.004C18.331,10.617,18.389,10.146,18.121,9.88 M14.963,17.245h-2.896v-3.313c0-0.229-0.186-0.415-0.414-0.415H8.342c-0.228,0-0.414,0.187-0.414,0.415v3.313H5.032v-6.628h9.931V17.245z M3.133,9.79l6.864-6.868l6.867,6.868H3.133z"></path>
          </svg>
        </a>
      </li>
      <li>
        <a href="https://virtual-thom.github.io/archives/vos-commentaires-livre-d-or/" title="Commentaires - livre d'or">
          <svg class="svg-icon" viewBox="0 0 20 20">
            <path d="M17.657,2.982H2.342c-0.234,0-0.425,0.191-0.425,0.426v10.21c0,0.234,0.191,0.426,0.425,0.426h3.404v2.553c0,0.397,0.48,0.547,0.725,0.302l2.889-2.854h8.298c0.234,0,0.426-0.191,0.426-0.426V3.408C18.083,3.174,17.892,2.982,17.657,2.982M17.232,13.192H9.185c-0.113,0-0.219,0.045-0.3,0.124l-2.289,2.262v-1.96c0-0.233-0.191-0.426-0.425-0.426H2.767V3.833h14.465V13.192z M10,7.237c-0.821,0-1.489,0.668-1.489,1.489c0,0.821,0.668,1.489,1.489,1.489c0.821,0,1.488-0.668,1.488-1.489C11.488,7.905,10.821,7.237,10,7.237 M10,9.364c-0.352,0-0.638-0.288-0.638-0.638c0-0.351,0.287-0.638,0.638-0.638c0.351,0,0.638,0.287,0.638,0.638C10.638,9.077,10.351,9.364,10,9.364 M14.254,7.237c-0.821,0-1.489,0.668-1.489,1.489c0,0.821,0.668,1.489,1.489,1.489s1.489-0.668,1.489-1.489C15.743,7.905,15.075,7.237,14.254,7.237 M14.254,9.364c-0.351,0-0.638-0.288-0.638-0.638c0-0.351,0.287-0.638,0.638-0.638c0.352,0,0.639,0.287,0.639,0.638C14.893,9.077,14.605,9.364,14.254,9.364 M5.746,7.237c-0.821,0-1.489,0.668-1.489,1.489c0,0.821,0.668,1.489,1.489,1.489c0.821,0,1.489-0.668,1.489-1.489C7.234,7.905,6.566,7.237,5.746,7.237 M5.746,9.364c-0.351,0-0.638-0.288-0.638-0.638c0-0.351,0.287-0.638,0.638-0.638c0.351,0,0.638,0.287,0.638,0.638C6.384,9.077,6.096,9.364,5.746,9.364"></path>
          </svg>
        </a>
      </li>
      
      <li>
        <a href="https://virtual-thom.github.io/about" title="Curriculum Vitae Thom">
          <svg class="svg-icon" viewBox="0 0 20 20">
            <path d="M12.075,10.812c1.358-0.853,2.242-2.507,2.242-4.037c0-2.181-1.795-4.618-4.198-4.618S5.921,4.594,5.921,6.775c0,1.53,0.884,3.185,2.242,4.037c-3.222,0.865-5.6,3.807-5.6,7.298c0,0.23,0.189,0.42,0.42,0.42h14.273c0.23,0,0.42-0.189,0.42-0.42C17.676,14.619,15.297,11.677,12.075,10.812 M6.761,6.775c0-2.162,1.773-3.778,3.358-3.778s3.359,1.616,3.359,3.778c0,2.162-1.774,3.778-3.359,3.778S6.761,8.937,6.761,6.775 M3.415,17.69c0.218-3.51,3.142-6.297,6.704-6.297c3.562,0,6.486,2.787,6.705,6.297H3.415z"></path>
          </svg>
        </a>
      </li>
    </ul>
  </nav>
</header>

      <div itemscope itemtype ="http://schema.org/Article" class="post">
  
  <header class="post-header">
    <h1 itemprop="name about headline" class="post-title">VTOM Cas d'√©cole n¬∞2</h1>
    <p class="post-meta">
      <time itemprop="datePublished dateModified" datetime="2023-01-11T18:00:00+00:00">11-01-2023</time></p>
  </header>

  <article class="post-content" itemprop="articleBody">
    <h1 class="hidden">VTOM Cas d'√©cole n¬∞2</h1>
    <p>Contexte et souhait du client (d√©sol√© je ne les invente pas ü§ê) :</p>
<ul>
  <li>3 applications A, B, C, cycliques 5 min (cha√Ænes de jobs plut√¥t complexes √† l‚Äôint√©rieur, on verra que √ßa excluera une des possibilit√©s)</li>
  <li>l‚Äôapplication C ne doit pas tourner si A ou B est en cours</li>
  <li>A de 6h √† 23h</li>
  <li>B de 18h √† 23h</li>
  <li>C de 6h √† 23h</li>
  <li>on part du principe que les cycles s‚Äôenchainent correctement et qu‚Äôune fois C en cours, peut importe le comportement de A ou de B
<!--more-->
Probl√®me √©vident, sur un cha√Ænage ‚Äúclassique‚Äù des 3 applications, l‚Äôapplication B attend 18hn, reste AVENIR et bloque (lien non valide) l‚Äôex√©cution de C :</li>
</ul>

<p><img src="https://virtual-thom.github.io/archives/wp-content/uploads/vtom_cas_ecole_n2_problem.jpg" alt="vtom_cas_ecole_n2_problem.jpg" /></p>

<h2 id="les-trucs-qui-ne-fonctionnent-pas">Les trucs qui ne fonctionnent pas</h2>
<h3 id="liens-or">Liens OR</h3>
<p>S√©duisant, car effectivement jusqu‚Äô√† 18h, √ßa fonctionne. A mon grand √©tonnement d‚Äôailleurs car de prime abord, je pensais qu‚Äôil fallait que les deux liens soient statu√©s. Mais non, tests en image, un seul lien OR est valide pour le d√©clenchement de C.</p>

<p><img src="https://virtual-thom.github.io/archives/wp-content/uploads/vtom_cas_ecole_n2_OR_1.jpg" alt="vtom_cas_ecole_n2_OR_1.jpg" /></p>

<p>Mais √† 18h, on risque de tomber sur le cas (par ex) o√π A est TERMINE et B ENCOURS, et C se lance quand m√™me √©tant donn√© qu‚Äôun lien OR est valide.</p>

<p><img src="https://virtual-thom.github.io/archives/wp-content/uploads/vtom_cas_ecole_n2_OR_2.jpg" alt="vtom_cas_ecole_n2_OR_2.jpg" /></p>

<h3 id="b-date-diff√©rente-bascule-√†-42h-18h-j1">B date diff√©rente, bascule √† 42h (18h J+1)</h3>
<p>(solution du client, aie aie aie)</p>

<p>Alors oui, c‚Äôest √©l√©gant √† premi√®re vue, car B reste √† DEPLANIFIE de 23h √† 18h J+1, la date bascule √† 18h, B reprend son cycle jusqu‚Äô√† 23h etc. Sauf que non, C ne se d√©clenche pas.</p>

<p><img src="https://virtual-thom.github.io/archives/wp-content/uploads/vtom_cas_ecole_n2_datexy.jpg" alt="vtom_cas_ecole_n2_datexy.jpg" /></p>

<p>Bon, je tiens √† rappeler qu‚Äôautant que possible (toujours en fait pour ma part) ON NE MET PAS DE DATES DIFFERENTES DANS UNE MEME CHAINE VTOM.<br />
Ca, c‚Äôest dit :p sauf qu‚Äôune fois qu‚Äôon vous a dit √ßa depuis que le monde est monde (au moins), on ne vous a peut-√™tre jamais expliqu√© pourquoi.<br />
Pourquoi : car 1 date == 1 plan, et √ßa n‚Äôest pas logique de lier entre eux des objets qui ne sont pas sur le m√™me plan, mais surtout un lien prend aussi en compte la date et reste invalide si le parent est √† une date diff√©rente (J-1 pour l‚Äôex.)</p>

<h2 id="ca-marche-class√©-de-la-pire--√†-la-moins-pire-">Ca marche, class√© de la pire ‚Ä¶ √† la moins pire ^^</h2>
<h3 id="ressources-textes">Ressources Textes</h3>
<p>Je ne m‚Äôattarde pas trop l√† dessus. Comme je le disais au d√©but, c‚Äôest compliqu√© de relier tous les jobs √† l‚Äôint√©rieur des cha√Ænes pour avoir une en-t√™te qui valorise √† ENCOURS et une fin qui remet √† OK la ressource. Et je ne trouve pas la solution hyper √©l√©gante ; les go√ªts et les couleurs.  <br />
Mais quand m√™me, voici une r√©flexion possible :</p>
<ul>
  <li>C attend T_RES_A et T_RES_B √† OK</li>
  <li>D√®s que A ENCOURS, valorise T_RES_A ENCOURS</li>
  <li>D√®s que B ENCOURS, valorise T_RES_B ENCOURS</li>
</ul>

<p>Petite pr√©cision, √ßa me parait compliqu√© de mettre des applications d‚Äôen-t√™te et de fin pour les valorisations de ressource texte. On n‚Äôest pas s√ªr √† 100% que les cycles se suivent par ex.</p>

<h3 id="ressource-poids">Ressource poids</h3>
<ul>
  <li>ressource poids √† max 2</li>
  <li>A et B prennent 1, attendent ind√©finiment, et lib√®re</li>
  <li>C prends 2, attend ind√©finiment, et lib√®re</li>
</ul>

<p><img src="https://virtual-thom.github.io/archives/wp-content/uploads/vtom_cas_ecole_n2_poids.jpg" alt="vtom_cas_ecole_n2_poids.jpg" /></p>

<p>Bon √ßa fonctionne, rien √† dire. Mais je n‚Äôai jamais aim√© les poids. Deux raisons √† cela :</p>
<ol>
  <li>Selon les cas, si on force √† TERMINE, √ßa ne lib√®re pas la ressource (je dis √ßa de m√©moire, √† v√©rifier mais j‚Äôai eu beaucoup d‚Äôincidents de ce genre, notamment avec les √©quipes de Pilotage).   <br />
Evidemment, si une ressource reste √† 1/2 pour x ou y raison, C ne se lancera jamais.</li>
  <li>C‚Äôest assez difficile, selon moi, de suivre la vie d‚Äôune ressource poids. Rien dans l‚Äôhistorique. Pas de job, donc pas d‚Äôex√©cution / log non plus.</li>
</ol>

<h3 id="ressource-num√©rique">Ressource num√©rique</h3>
<p>Je n‚Äôarrive plus √† me rappeler dans quels cas on utilisait les ressources num√©riques chez BPCE-IT (surement des jours de mois). Mais √ßa m‚Äôa permis de penser √† cette derni√®re solution.</p>

<ul>
  <li>ressource num√©rique</li>
  <li>une application cyclique toutes les heures, de 0h √† 23h59, avec un job qui valorise √† HH la ressource num√©rique (1h ress √† 1, 2h ress √† 2, etc. jusqu‚Äô√† 23)<br />
en powershell, c‚Äôest assez simple : <code class="language-plaintext highlighter-rouge">tval -name NOMRESNUM -value $(date -format "HH")</code> √† ex√©cuter sur le client du serveur VTOM<br />
En g√©n√©ral, c‚Äôest le genre de job qu‚Äôon mettrait bien dans un ENV admin VTOM mais je le d√©conseille. Ca rajouterait une d√©pendance peu souhaitable entre divers environnements. Autant le mettre dans le m√™me env applicatif, si c‚Äôest possible.</li>
  <li>B de 6h √† 23h (cette fois hmin doit √™tre identique au reste et non 18h), ‚Äúne pas attendre‚Äù, expect ressource num√©rique &gt;= 18</li>
</ul>

<p>Avant 18h, B se d√©planifie bien (enfin resnopla=o je trouve plus ‚Äújoli‚Äù d‚Äôavoir des objets NONPLANIFIE plut√¥t que DEPLANIFIE quand la contrainte n‚Äôest pas v√©rifi√©e et qu‚Äôon est en ‚Äúne pas attendre‚Äù. Juste pour rappel, NONPLANIFIE == valide les liens, DEPLANIFIE == ne valide pas les liens)<br />
<img src="https://virtual-thom.github.io/archives/wp-content/uploads/vtom_cas_ecole_n2_ress_num_1.jpg" alt="vtom_cas_ecole_n2_ress_num_1.jpg" /></p>

<p>Apr√®s 18h, B peut s‚Äôex√©cuter, mais C attendra bien que A ET B soient statu√©s.<br />
<img src="https://virtual-thom.github.io/archives/wp-content/uploads/vtom_cas_ecole_n2_ress_num_2.jpg" alt="vtom_cas_ecole_n2_ress_num_2.jpg" /></p>

<p>J‚Äôy vois un inconv√©nient majeur : le top d√©part pourrait √™tre retard√© (d√©pend du cycle qui valorise la ress num, ex. pour x ou y raison, on red√©marre un moteur √† xxh32min, le cycle d‚Äôune heure qui valorise la ress num va √™tre d√©cal√© √† HH+32min)</p>

<h3 id="ressource-texte-bis">Ressource texte (bis)</h3>
<p>C‚Äôest en faisant l‚Äôarticle que j‚Äôai pens√© √† celui-ci.<br />
On part sur la m√™me id√©e de la ressource num√©rique avec une contrainte et ‚Äúne pas attendre‚Äù mais presque sans les incov√©nients.</p>

<ul>
  <li>Application 18h hmin, job qui valorise ressource texte √† GO</li>
  <li>B de 6h √† 23h (cette fois hmin doit √™tre identique au reste et non 18h), expect ressource text √† GO, ‚Äúne pas attendre‚Äù</li>
</ul>

<p>Seuls inconv√©nients que je vois l√† tout de suite, c‚Äôest le fait d‚Äô√™tre encore d√©pendant d‚Äôun top horaire d‚Äôune autre application (mais d√©j√† plus s√ªr que le num) et de rajouter encore 1 autre application en d√©but, ou fin de journ√©e, pour r√©initialiser la ressource texte √† ‚ÄúWAIT‚Äù.</p>

<p>Et vous, comment auriez-vous fait ?</p>


  </article>
  
<nav>
  <ul class="pager">
    
     
    <li class="previous">
      <a href="https://virtual-thom.github.io/archives/rpi4-wifi-dhcp-lost-ipv4/"><span aria-hidden="true">&larr;</span> RPI4 WiFi wlan0 lost its ip address</a> 
    </li>
    
     
     <li class="next">
      <a class="next" href="https://virtual-thom.github.io/archives/open-workbook-excel-taskscheduler-vtom/">Microsoft Excel Microsoft Excel cannot access the file <span aria-hidden="true">&rarr;</span></a> 
    </li>
     
    
  </ul>
</nav>


  <footer class="post-footer">
    
      
    
    <span  itemprop="author publisher" class="hidden">Virtual Thom</span>
  </footer>
  
  <div id="disqus_thread" ></div>
  <script>
      var disqus_shortname = atob('dGhvbWFzLWFzbmFy'); 
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
</div>

      <footer id="site-footer">
    <div>&copy;<a href="https://github.com/virtual-thom/" title="Github Virtual-Thom">Virtual-Thom</a></div>
    <div>
            <a href="https://virtual-thom.github.io/archives/plan" title="Plan du site">sitemap</a> | <a href="https://virtual-thom.github.io/about" rel="publisher author" title="Curriculum vitae Thom">A propos</a>
    </div>
    <div>
        <a id="goto-site-header" href="#site-header" title="Retourner au d√©but">&uArr; Top</a>
    </div>
    <div id="footer-disclaimer">
        <p>Avertissement : vous ne devez pas prendre pour argent comptant le contenu de ce site. Testez toujours la solution en environnement de test.</p>
        <p>Malgr√© le s√©rieux que je m'efforce de mettre dans le contenu de ces billets, je ne pourrai √™tre tenu responsable d'√©ventuelles erreurs que cela pourrait engendrer.</p>
    </div>
    <div>
        <a class="hidden" href="https://virtual-thom.github.io/archives/sitemap.xml" title="SiteMap">sitemap</a>
    </div>
</footer>

    </div>
  </body>

</html>