<!DOCTYPE html>
<html lang="fr">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="apple-touch-icon" href="https://virtual-thom.github.io/archives/apple-touch-icon.png">
  <link rel="icon" href="https://virtual-thom.github.io/archives/favicon.ico" />
  <!-- Remplacé par Jekyll SEO (sinon apparait en double)
  <title>Virtual-Thom | Blog-notes VTOM et informatique</title>
  <meta name="description" content="Blog-notes VTOM, informatique, industrialisation, ordonnancement, DevOps">
  --> 
  
  <link rel="canonical" href="https://virtual-thom.github.io/archives/page10/">
  
  <link rel="stylesheet" media="screen" href="https://virtual-thom.github.io/archives/assets/main.css">
  
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Page 10 of 14 for Virtual-Thom Blog-notes VTOM et informatique | Blog-notes VTOM, informatique, industrialisation, ordonnancement, DevOps</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Virtual-Thom Blog-notes VTOM et informatique" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Blog-notes VTOM, informatique, industrialisation, ordonnancement, DevOps" />
<meta property="og:description" content="Blog-notes VTOM, informatique, industrialisation, ordonnancement, DevOps" />
<link rel="canonical" href="https://virtual-thom.github.io/archives/page10/" />
<meta property="og:url" content="https://virtual-thom.github.io/archives/page10/" />
<meta property="og:site_name" content="Virtual-Thom Blog-notes VTOM et informatique" />
<meta property="og:type" content="website" />
<link rel="prev" href="https://virtual-thom.github.io/archives/page9" />
<link rel="next" href="https://virtual-thom.github.io/archives/page11" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Virtual-Thom Blog-notes VTOM et informatique" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Blog-notes VTOM, informatique, industrialisation, ordonnancement, DevOps","headline":"Virtual-Thom Blog-notes VTOM et informatique","url":"https://virtual-thom.github.io/archives/page10/"}</script>
<!-- End Jekyll SEO tag -->

  
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Z8Y7902GRV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Z8Y7902GRV');
</script>


  <body>
    <div class="container">
      <header id="site-header">
  <h1>Blog-notes VTOM, informatique, industrialisation, ordonnancement, DevOps</h1>
  <nav>
    <ul>
      <li>
        <a href="https://virtual-thom.github.io/archives" title="Home">
          <svg class="svg-icon" viewBox="0 0 20 20">
            <path d="M18.121,9.88l-7.832-7.836c-0.155-0.158-0.428-0.155-0.584,0L1.842,9.913c-0.262,0.263-0.073,0.705,0.292,0.705h2.069v7.042c0,0.227,0.187,0.414,0.414,0.414h3.725c0.228,0,0.414-0.188,0.414-0.414v-3.313h2.483v3.313c0,0.227,0.187,0.414,0.413,0.414h3.726c0.229,0,0.414-0.188,0.414-0.414v-7.042h2.068h0.004C18.331,10.617,18.389,10.146,18.121,9.88 M14.963,17.245h-2.896v-3.313c0-0.229-0.186-0.415-0.414-0.415H8.342c-0.228,0-0.414,0.187-0.414,0.415v3.313H5.032v-6.628h9.931V17.245z M3.133,9.79l6.864-6.868l6.867,6.868H3.133z"></path>
          </svg>
        </a>
      </li>
      <li>
        <a href="https://virtual-thom.github.io/archives/vos-commentaires-livre-d-or/" title="Commentaires - livre d'or">
          <svg class="svg-icon" viewBox="0 0 20 20">
            <path d="M17.657,2.982H2.342c-0.234,0-0.425,0.191-0.425,0.426v10.21c0,0.234,0.191,0.426,0.425,0.426h3.404v2.553c0,0.397,0.48,0.547,0.725,0.302l2.889-2.854h8.298c0.234,0,0.426-0.191,0.426-0.426V3.408C18.083,3.174,17.892,2.982,17.657,2.982M17.232,13.192H9.185c-0.113,0-0.219,0.045-0.3,0.124l-2.289,2.262v-1.96c0-0.233-0.191-0.426-0.425-0.426H2.767V3.833h14.465V13.192z M10,7.237c-0.821,0-1.489,0.668-1.489,1.489c0,0.821,0.668,1.489,1.489,1.489c0.821,0,1.488-0.668,1.488-1.489C11.488,7.905,10.821,7.237,10,7.237 M10,9.364c-0.352,0-0.638-0.288-0.638-0.638c0-0.351,0.287-0.638,0.638-0.638c0.351,0,0.638,0.287,0.638,0.638C10.638,9.077,10.351,9.364,10,9.364 M14.254,7.237c-0.821,0-1.489,0.668-1.489,1.489c0,0.821,0.668,1.489,1.489,1.489s1.489-0.668,1.489-1.489C15.743,7.905,15.075,7.237,14.254,7.237 M14.254,9.364c-0.351,0-0.638-0.288-0.638-0.638c0-0.351,0.287-0.638,0.638-0.638c0.352,0,0.639,0.287,0.639,0.638C14.893,9.077,14.605,9.364,14.254,9.364 M5.746,7.237c-0.821,0-1.489,0.668-1.489,1.489c0,0.821,0.668,1.489,1.489,1.489c0.821,0,1.489-0.668,1.489-1.489C7.234,7.905,6.566,7.237,5.746,7.237 M5.746,9.364c-0.351,0-0.638-0.288-0.638-0.638c0-0.351,0.287-0.638,0.638-0.638c0.351,0,0.638,0.287,0.638,0.638C6.384,9.077,6.096,9.364,5.746,9.364"></path>
          </svg>
        </a>
      </li>
      
      <li>
        <a href="https://virtual-thom.github.io/about" title="Curriculum Vitae Thom">
          <svg class="svg-icon" viewBox="0 0 20 20">
            <path d="M12.075,10.812c1.358-0.853,2.242-2.507,2.242-4.037c0-2.181-1.795-4.618-4.198-4.618S5.921,4.594,5.921,6.775c0,1.53,0.884,3.185,2.242,4.037c-3.222,0.865-5.6,3.807-5.6,7.298c0,0.23,0.189,0.42,0.42,0.42h14.273c0.23,0,0.42-0.189,0.42-0.42C17.676,14.619,15.297,11.677,12.075,10.812 M6.761,6.775c0-2.162,1.773-3.778,3.358-3.778s3.359,1.616,3.359,3.778c0,2.162-1.774,3.778-3.359,3.778S6.761,8.937,6.761,6.775 M3.415,17.69c0.218-3.51,3.142-6.297,6.704-6.297c3.562,0,6.486,2.787,6.705,6.297H3.415z"></path>
          </svg>
        </a>
      </li>
    </ul>
  </nav>
</header>

      <nav>
  <ul class="pagination">
    
    <li>
      <a href="/page9" class="Précédant">
        <span aria-hidden="true">&laquo;</span>
      </a>
    </li>
      
    <li>
      <a href="/archives/index.html">1</a>
    </li>
      
    <li>
      <a
        href="/archives/page2">2</a>
    </li>
      
    <li>
      <a
        href="/archives/page3">3</a>
    </li>
      
    <li>
      <a
        href="/archives/page4">4</a>
    </li>
      
    <li>
      <a
        href="/archives/page5">5</a>
    </li>
      
    <li>
      <a
        href="/archives/page6">6</a>
    </li>
      
    <li>
      <a
        href="/archives/page7">7</a>
    </li>
      
    <li>
      <a
        href="/archives/page8">8</a>
    </li>
      
    <li>
      <a
        href="/archives/page9">9</a>
    </li>
      
    <li class="active">
      <span>10</span>
    </li>
      
    <li>
      <a
        href="/archives/page11">11</a>
    </li>
      
    <li>
      <a
        href="/archives/page12">12</a>
    </li>
      
    <li>
      <a
        href="/archives/page13">13</a>
    </li>
      
    <li>
      <a
        href="/archives/page14">14</a>
    </li>
      
    <li>
      <a href="/page11" aria-label="Suivant">
        <span aria-hidden="true">&raquo;</span>
      </a>
    </li>
    
  </ul>
</nav>
<ul class="post-list post-list-with-type">
  
  <li>
    <a class="post-link" href="/archives/netbackup-lister-job-sauvegardes-en-cours/">Lister les sauvegardes Netbackup en cours</a>
  </li>
  
  <li>
    <a class="post-link" href="/archives/IHM-VTOM-tunnel-ssh-DMZ/">IHM VTOM via un tunnel ssh</a>
  </li>
  
  <li>
    <a class="post-link" href="/archives/powershell-rapport-snapshots-vmware/">Rapport snapshots VMWare Powershell</a>
  </li>
  
  <li>
    <a class="post-link" href="/archives/pas-de-retour-tsend-client-vtom-unix/">Pas de retour tsend client vtom unix</a>
  </li>
  
  <li>
    <a class="post-link" href="/archives/sendmail-vtom/">sendmail pour vtom</a>
  </li>
  
  <li>
    <a class="post-link" href="/archives/extraire-crontab-serveurs-distants/">Extraction des crontabs de tous les utilisateurs en local ou à distance</a>
  </li>
  
  <li>
    <a class="post-link" href="/archives/vtom-compter-nombre-traitements-par-machine/">Compter le nombre de traitements VTOM par client</a>
  </li>
  
  <li>
    <a class="post-link" href="/archives/ajax-list-directory-github/">Lister le contenu d'un répertoire Github en ajax</a>
  </li>
  
  <li>
    <a class="post-link" href="/archives/heberger-page-site-web-vthttpd-webacess-vtom/">Héberger une page web depuis vthttpd web access VTOM</a>
  </li>
  
  <li>
    <a class="post-link" href="/archives/sun-solaris-zones-clients-vtom-bdaemon/">Clients VTOM zones Solaris</a>
  </li>
  
</ul>


<div id="page-first-post">

  <div itemscope itemtype="http://schema.org/Article" class="post">

    <article class="post-content" itemprop="articleBody">
      <h1 itemprop="name about headline" class="post-title">Lister les sauvegardes Netbackup en cours</h1>
      <p>Si le champ de la colonne n°3 de la commande netbackup <code class="language-plaintext highlighter-rouge">bpdbjobs -report -most_columns</code> est inférieur à 3, c’est qu’il y a des sauvegardes en cours, ou en préparation.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	bpdbjobs <span class="nt">-report</span> <span class="nt">-most_columns</span> | <span class="nb">awk</span> <span class="nt">-F</span><span class="s2">","</span> <span class="s1">'{ if( $3 &lt; 3 ){ print } }'</span> 
</code></pre></div></div>

<p>Rien à voir avec les sauvegardes en cours, mais voici une autre commande netbackup que j’utilise beaucoup pour lister les policies (stratégies de sauvegarde)  et les clients :</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bppllist 

<span class="c"># Détails d'une policie</span>
bppllist MAPOLICIE <span class="nt">-U</span> 

<span class="c"># Lister des policies en filtrant avec un client</span>
bppllist <span class="nt">-byclient</span> MONCLIENT

<span class="c"># Lister les clients </span>
bpplclients

</code></pre></div></div>

      (voir plus)
      <a class="post-link" href="/archives/netbackup-lister-job-sauvegardes-en-cours/">Lister les sauvegardes Netbackup en cours</a>
      <p class="post-meta">
        <time class="post-meta" itemprop="datePublished dateModified"
          datetime="2015-07-01T21:19:00+00:00">01-07-2015</time>
      </p>
    </article>
  </div>
</div>




















<ul class="post-list">
  
  
  
  
  <li>
    <div class="card">
      <h4><a class="post-link" href="/archives/IHM-VTOM-tunnel-ssh-DMZ/">IHM VTOM via un tunnel ssh</a></h4>
      <p><p>Enfin un truc fun ! (merci Stéphane pour l’astuce du tunnel)</p>

<p>Je suis sûr que ça vous est déjà arrivé d’avoir un serveur VTOM dans une DMZ (une zone démilitarisée sécurisée) et, de n’avoir que le port ssh d’ouvert pour vous connecter en putty au serveur.</p>

<p>Du coup, pas d’IHM VTOM sur votre poste de travail (IHM = Interface Homme Machine = console graphique d’admin et pilotage VTOM).</p>

<p>Qu’à cela ne tienne ! avec cette astuce, on peut créer un tunnel ssh de votre poste de travail vers votre serveur VTOM. On redirige alors tous les flux nécessaires (vtnotifier 30008 et vtserver 30007, ou les votres perso) de votre poste vers le serveur VTOM.</p>

<ul>
  <li>Configurer le tunnel ssh avec les flux VTOM dans PuTTY</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PuTTY Configuration &gt; Connection &gt; SSH &gt; Tunnels :
Source Port = 30007
Destination = &lt;@IP ou nom DNS du serveur VTOM&gt;:30007 
==&gt; Add
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Source Port = 30008
Destination = &lt;@IP ou nom DNS du serveur VTOM&gt;:30008
==&gt; Add
</code></pre></div></div>

<p><img src="https://virtual-thom.github.io/archives/assets/img/putty_Tunnels.jpg" alt="Tunnel SSH pour IHM VTOM" /></p>

<p>A vérifier, mais il faut peut-être rajouter les services dans %systemroot%\system32\drivers\etc\services</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vtserver 30007
vtnotifier 30008
</code></pre></div></div>
<p>(ou vos ports spécifiques)</p>

<ul>
  <li>Se connecter au serveur VTOM avec PuTTY pour créer le tunnel ssh</li>
</ul>

<p>Connexion classique. PuTTY Configuration &gt; Session &gt; Host Name (or IP) = @IP du serveur VTOM</p>

<p>Et “Open”</p>

<ul>
  <li>Se connecter à VTOM via l’IHM depuis votre poste de travail</li>
</ul>

<p>Ouvrir l’IHM VTOM, et mettre localhost au lieu du serveur VTOM. Et, voilà !</p>
</p>
      
    </div>

  </li>
  
  
  
  <li>
    <div class="card">
      <h4><a class="post-link" href="/archives/powershell-rapport-snapshots-vmware/">Rapport snapshots VMWare Powershell</a></h4>
      <p><div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">
    </span><span class="n">Export-Console</span><span class="w"> </span><span class="s2">"C:\Program Files (x86)\VMware\Infrastructure\vSphere PowerCLI\vim.psc1"</span><span class="w">
		</span><span class="n">import-module</span><span class="w"> </span><span class="s2">"C:\Program Files (x86)\VMware\Infrastructure\vSphere PowerCLI\Scripts\Initialize-PowerCLIEnvironment.ps1"</span><span class="w">
		</span><span class="n">Connect-VIServer</span><span class="w"> </span><span class="nt">-Server</span><span class="w"> </span><span class="nv">$</span><span class="nn">script</span><span class="p">:</span><span class="nv">VCENTER_SERVER</span><span class="w"> </span><span class="nt">-Protocol</span><span class="w"> </span><span class="nx">https</span><span class="w"> </span><span class="nt">-User</span><span class="w"> </span><span class="nv">$</span><span class="nn">script</span><span class="p">:</span><span class="nv">VCENTER_USER</span><span class="w"> </span><span class="nt">-Password</span><span class="w"> </span><span class="nv">$</span><span class="nn">script</span><span class="p">:</span><span class="nv">VCENTER_PASSWORD</span><span class="w">
		</span><span class="kr">if</span><span class="p">(</span><span class="bp">$?</span><span class="w"> </span><span class="o">-ne</span><span class="w"> </span><span class="nv">$True</span><span class="p">){</span><span class="w">
			</span><span class="n">fn_WriteLog</span><span class="w"> </span><span class="s2">"ERROR -- Impossible de se connecter au vCenter </span><span class="nv">${VCENTER_SERVER}</span><span class="s2">"</span><span class="w">
			</span><span class="nv">$</span><span class="nn">script</span><span class="p">:</span><span class="nv">vRC_CODE</span><span class="o">=</span><span class="mi">20</span><span class="w">
			</span><span class="kr">break</span><span class="w">
		</span><span class="p">}</span><span class="w">
		
		</span><span class="c"># Récupération des snaphots</span><span class="w">
		</span><span class="nv">$</span><span class="nn">script</span><span class="p">:</span><span class="nv">SNAPSHOTS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get-vm</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="kr">foreach</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">$VM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">$_</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="bp">$_</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">get-snapshot</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="nx">VM</span><span class="p">,@{</span><span class="nx">Label</span><span class="o">=</span><span class="s2">"VM Powerstate"</span><span class="p">;</span><span class="nx">Expression</span><span class="o">=</span><span class="p">{</span><span class="nv">$VM</span><span class="o">.</span><span class="nf">PowerState</span><span class="p">}},</span><span class="nx">Name</span><span class="p">,</span><span class="nx">Description</span><span class="p">,@{</span><span class="nx">Label</span><span class="o">=</span><span class="s2">"Size"</span><span class="p">;</span><span class="nx">Expression</span><span class="o">=</span><span class="p">{</span><span class="s2">"{0:N2}"</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="p">(</span><span class="bp">$_</span><span class="o">.</span><span class="nf">SizeGB</span><span class="p">)}},</span><span class="nx">Created</span><span class="w">
		</span><span class="c"># On tri selon les critères en paramètre </span><span class="w">
		</span><span class="c"># et on filtre sur le ou les pattern</span><span class="w">
		</span><span class="nv">$PATTERN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@()</span><span class="w">
		</span><span class="nv">$</span><span class="nn">script</span><span class="p">:</span><span class="nv">SNAPSHOT_PATTERN</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kr">foreach</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="bp">$_</span><span class="o">.</span><span class="nf">getEnumerator</span><span class="p">()</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kr">foreach</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">$PATTERN</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">"</span><span class="se">`$</span><span class="s2">_."</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="bp">$_</span><span class="o">.</span><span class="nf">key</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" -match </span><span class="se">`"</span><span class="s2">"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="bp">$_</span><span class="o">.</span><span class="nf">value</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"</span><span class="se">`"</span><span class="s2">"</span><span class="w"> </span><span class="p">}</span><span class="w">
		</span><span class="nv">$PATTERN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$PATTERN</span><span class="w"> </span><span class="o">-join</span><span class="w"> </span><span class="s2">" -or "</span><span class="w">
		</span><span class="kr">if</span><span class="p">(</span><span class="nv">$</span><span class="nn">script</span><span class="p">:</span><span class="nv">SNAPSHOT_SORT_DESCENDING</span><span class="p">){</span><span class="w">
			</span><span class="nv">$</span><span class="nn">script</span><span class="p">:</span><span class="nv">SNAPSHOTS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$</span><span class="nn">script</span><span class="p">:</span><span class="nv">SNAPSHOTS</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">sort-object</span><span class="w"> </span><span class="nv">$</span><span class="nn">script</span><span class="p">:</span><span class="nv">SNAPSHOT_SORT_BY</span><span class="w"> </span><span class="nt">-descending</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">where-object</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">invoke-expression</span><span class="w"> </span><span class="nv">$PATTERN</span><span class="w"> </span><span class="p">}</span><span class="w">
		</span><span class="p">}</span><span class="kr">else</span><span class="p">{</span><span class="w">
			</span><span class="nv">$</span><span class="nn">script</span><span class="p">:</span><span class="nv">SNAPSHOTS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$</span><span class="nn">script</span><span class="p">:</span><span class="nv">SNAPSHOTS</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">sort-object</span><span class="w"> </span><span class="nv">$</span><span class="nn">script</span><span class="p">:</span><span class="nv">SNAPSHOT_SORT_BY</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">where-object</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">invoke-expression</span><span class="w"> </span><span class="nv">$PATTERN</span><span class="w"> </span><span class="p">}</span><span class="w">
		</span><span class="p">}</span><span class="w">
		
		</span><span class="kr">if</span><span class="p">(</span><span class="bp">$?</span><span class="w"> </span><span class="o">-ne</span><span class="w"> </span><span class="nv">$True</span><span class="p">){</span><span class="w">
			</span><span class="n">fn_WriteLog</span><span class="w"> </span><span class="s2">"ERROR -- Impossible de récupérer la liste des snapshots"</span><span class="w">
			</span><span class="nv">$</span><span class="nn">script</span><span class="p">:</span><span class="nv">vRC_CODE</span><span class="o">=</span><span class="mi">21</span><span class="w">
			</span><span class="kr">break</span><span class="w">
		</span><span class="p">}</span><span class="w">
		
		</span><span class="c"># On se déconnecte</span><span class="w">
		</span><span class="n">Disconnect-VIServer</span><span class="w"> </span><span class="nt">-Server</span><span class="w"> </span><span class="nv">$</span><span class="nn">script</span><span class="p">:</span><span class="nv">VCENTER_SERVER</span><span class="w"> </span><span class="nt">-Force</span><span class="p">:</span><span class="bp">$true</span><span class="w"> </span><span class="nt">-Confirm</span><span class="p">:</span><span class="bp">$false</span><span class="w">
		
</span></code></pre></div></div>
</p>
      
    </div>

  </li>
  
  
  
  <li>
    <div class="card">
      <h4><a class="post-link" href="/archives/pas-de-retour-tsend-client-vtom-unix/">Pas de retour tsend client vtom unix</a></h4>
      <p><p>Il peut arriver qu’un traitement s’exécute bien (code retour 0 terminé OK) mais qu’on n’ait pas de retour tsend sur VTOM (terminé en erreur)</p>

<p>Si le retour s’effectue bien avec l’utilisateur de soumission “vtom” ou “root” mais pas pour les autres utilisateurs, il y a de grandes chances que les droits du répertoire spool ne soient pas en 777 comme ils devraient l’être.</p>
</p>
      
    </div>

  </li>
  
  
  
  <li>
    <div class="card">
      <h4><a class="post-link" href="/archives/sendmail-vtom/">sendmail pour vtom</a></h4>
      <p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/ksh</span>
<span class="c">#On prend les 3 premiers arguments pour sujet, sender, dest</span>
<span class="nv">SUJET</span><span class="o">=</span><span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>
<span class="nb">shift
</span><span class="nv">SENDER</span><span class="o">=</span><span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>
<span class="nb">shift
</span><span class="nv">DEST</span><span class="o">=</span><span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>
<span class="nb">shift</span>

<span class="c"># $@ ==&gt; tous les autres arguments constitueront le body du message mail</span>
<span class="o">(</span>
<span class="nb">cat</span> <span class="o">&lt;&lt;</span> <span class="no">EOF</span><span class="sh">
From: </span><span class="nv">$SENDER</span><span class="sh"> 
To: </span><span class="nv">$DEST</span><span class="sh">
Subject: </span><span class="nv">$SUJET</span><span class="sh">
Content-Type: text/html
</span><span class="no">EOF
</span><span class="nb">echo</span> <span class="s2">"&lt;html&gt;&lt;h1&gt;</span><span class="nv">$SUJET</span><span class="s2">&lt;/h1&gt;&lt;body&gt;"</span> 
<span class="k">while </span><span class="nb">test</span> <span class="nv">$# </span><span class="nt">-gt</span> 0
<span class="k">do
  </span><span class="nb">echo</span> <span class="nv">$1</span><span class="s2">"&lt;br&gt;"</span> 
  <span class="nb">shift
</span><span class="k">done
</span><span class="nb">echo</span> <span class="s2">"&lt;/body&gt;&lt;/html&gt;"</span>
<span class="o">)</span> | sendmail <span class="nt">-oi</span> <span class="nt">-t</span>
</code></pre></div></div>
</p>
      
    </div>

  </li>
  
  
  
  <li>
    <div class="card">
      <h4><a class="post-link" href="/archives/extraire-crontab-serveurs-distants/">Extraction des crontabs de tous les utilisateurs en local ou à distance</a></h4>
      <p><p>Le principe est d’exécuter  <code class="language-plaintext highlighter-rouge">crontab -l -u user</code> (linux) ou <code class="language-plaintext highlighter-rouge">crontab -l user</code> (solaris) pour tous les utilisateurs et pour tous les serveurs distants passés en paramètre dans un fichier.</p>

<p>Voici comment récupérer facilement la liste de vos clients :</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vtmachine | <span class="nb">awk</span>  <span class="nt">-F</span><span class="s2">"|"</span> <span class="s1">'$7 ~ /Win/ {print $3}'</span> | <span class="nb">sed</span> <span class="s1">'s/^[ \t]*\|[ \t]*$//g'</span> <span class="o">&gt;</span> /var/tmp/liste_client_windows.txt
vtmachine | <span class="nb">awk</span>  <span class="nt">-F</span><span class="s2">"|"</span> <span class="s1">'$7 ~ /Sol|Lin/ {print $3}'</span> | <span class="nb">sed</span> <span class="s1">'s/^[ \t]*\|[ \t]*$//g'</span> <span class="o">&gt;</span> /var/tmp/liste_client_unix.txt
</code></pre></div></div>

<p>Script shell à télécharger : <a href="https://virtual-thom.github.io/archives/scripts/Extract_Crontab.sh">Extract_Crontab.sh</a></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Script qui pousse un sous-script permettant d'afficher la crontab de tous les utilisateurs</span>
<span class="c"># et l'exécute sur des serveurs distants </span>
<span class="c"># ou en local si aucun paramètre</span>
<span class="c"># A lancer en root</span>

<span class="c"># Le premier paramètre doit être le chemin complet d'un fichier listant des serveurs linux ou Solaris</span>
<span class="c"># Le serveur sur lequel est exécuté le script doit pouvoir communiquer en ssh avec les serveurs distants</span>
<span class="nv">FIC_LISTE_SERVEURS</span><span class="o">=</span><span class="nv">$1</span>

<span class="c"># On set le code retour à 0</span>
<span class="nv">CR</span><span class="o">=</span>0

<span class="c"># Sous-script à exécuter sur les serveurs distants</span>
<span class="nv">FIC_SUBSCRIPT</span><span class="o">=</span>/var/tmp/<span class="sb">`</span><span class="nb">basename</span> <span class="nv">$0</span><span class="sb">`</span>_<span class="k">${</span><span class="nv">RANDOM</span><span class="k">}</span>_<span class="sb">`</span><span class="nb">date</span> +<span class="s2">"%d%m%Y"</span><span class="sb">`</span>.sh

<span class="c"># fichier de sortie des crontabs -l des utilisateurs </span>
<span class="c"># format hostname;user;ligne crontab (commentaires et lignes vides non prises en compte)</span>
<span class="nv">FIC_SORTIE_EXT_CRONTAB</span><span class="o">=</span>/var/tmp/<span class="sb">`</span><span class="nb">basename</span> <span class="nv">$0</span><span class="sb">`</span>_<span class="k">${</span><span class="nv">RANDOM</span><span class="k">}</span>_<span class="sb">`</span><span class="nb">date</span> +<span class="s2">"%d%m%Y"</span><span class="sb">`</span>.csv
<span class="o">&gt;</span> <span class="k">${</span><span class="nv">FIC_SORTIE_EXT_CRONTAB</span><span class="k">}</span>

<span class="c"># Ecriture du sous-script</span>
<span class="c"># si le crontab -l -u user ne fonctionne pas sur votre machine distante, on peut imaginer créer</span>
<span class="c"># une couche d'abstraction pour la commande crontab selon l'OS</span>
<span class="nb">echo</span> <span class="s2">"awk -F</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2"> '</span><span class="se">\$</span><span class="s2">NF !~ /(nologin|sync|shutdown|halt|false)/ {print </span><span class="se">\$</span><span class="s2">1}' /etc/passwd | while read user ;do </span><span class="se">\</span><span class="s2">
export user; </span><span class="se">\</span><span class="s2">
FIC_TEMP=/var/tmp/</span><span class="se">\$</span><span class="s2">{RANDOM}_crontab-l; </span><span class="se">\</span><span class="s2">
crontab -l -u </span><span class="se">\$</span><span class="s2">{user} &gt; </span><span class="se">\$</span><span class="s2">FIC_TEMP 2&gt; /dev/null ; </span><span class="se">\</span><span class="s2">
if test </span><span class="se">\$</span><span class="s2">? -ne 0 ; then </span><span class="se">\</span><span class="s2">
 crontab -l </span><span class="se">\$</span><span class="s2">{user} &gt; </span><span class="se">\$</span><span class="s2">FIC_TEMP 2&gt; /dev/null ; </span><span class="se">\</span><span class="s2">
 if test </span><span class="se">\$</span><span class="s2">? -ne 0 ; then </span><span class="se">\</span><span class="s2">
  rm -f </span><span class="se">\$</span><span class="s2">FIC_TEMP; </span><span class="se">\</span><span class="s2">
  continue ; </span><span class="se">\</span><span class="s2">
 fi ; </span><span class="se">\</span><span class="s2">
fi ; </span><span class="se">\</span><span class="s2">
while read line ; do </span><span class="se">\</span><span class="s2">
 if test -z </span><span class="se">\"\$</span><span class="s2">line</span><span class="se">\"</span><span class="s2"> ; then </span><span class="se">\</span><span class="s2">
  continue ; </span><span class="se">\</span><span class="s2">
 fi ; </span><span class="se">\</span><span class="s2">
 echo </span><span class="se">\"\$</span><span class="s2">line</span><span class="se">\"</span><span class="s2"> | grep </span><span class="se">\"</span><span class="s2">^#</span><span class="se">\"</span><span class="s2"> &gt; /dev/null 2&gt;&amp;1 ;</span><span class="se">\</span><span class="s2">
 if test </span><span class="se">\$</span><span class="s2">? -eq 0 ; then </span><span class="se">\</span><span class="s2">
  continue ; </span><span class="se">\</span><span class="s2">
 fi ; </span><span class="se">\</span><span class="s2">
 printf </span><span class="se">\"</span><span class="s2">%s;%s;%s;</span><span class="se">\\\n\"</span><span class="s2"> </span><span class="se">\"\`</span><span class="s2">uname -n</span><span class="se">\`\"</span><span class="s2"> </span><span class="se">\"\$</span><span class="s2">{user}</span><span class="se">\"</span><span class="s2"> </span><span class="se">\"\$</span><span class="s2">{line}</span><span class="se">\"</span><span class="s2"> ; </span><span class="se">\</span><span class="s2">
done &lt; </span><span class="se">\$</span><span class="s2">{FIC_TEMP}; </span><span class="se">\</span><span class="s2">
rm -f </span><span class="se">\$</span><span class="s2">FIC_TEMP; 
done"</span> <span class="o">&gt;</span> <span class="k">${</span><span class="nv">FIC_SUBSCRIPT</span><span class="k">}</span>


<span class="c"># Si la liste des serveurs distants est vide, on exécute le sous-script en local</span>
<span class="k">if </span><span class="nb">test</span> <span class="nt">-z</span> <span class="s2">"</span><span class="k">${</span><span class="nv">FIC_LISTE_SERVEURS</span><span class="k">}</span><span class="s2">"</span><span class="p">;</span><span class="k">then
  </span><span class="nb">chmod</span> +x <span class="k">${</span><span class="nv">FIC_SUBSCRIPT</span><span class="k">}</span>
  <span class="k">${</span><span class="nv">FIC_SUBSCRIPT</span><span class="k">}</span> <span class="o">&gt;&gt;</span>  <span class="k">${</span><span class="nv">FIC_SORTIE_EXT_CRONTAB</span><span class="k">}</span>
<span class="k">else
  </span><span class="nv">NB_SERVEURS</span><span class="o">=</span><span class="sb">`</span><span class="nb">cat</span> <span class="k">${</span><span class="nv">FIC_LISTE_SERVEURS</span><span class="k">}</span> | <span class="nb">wc</span> <span class="nt">-l</span><span class="sb">`</span>
  <span class="nv">BOUCLE_COURRANTE</span><span class="o">=</span>0

  
  <span class="k">while </span><span class="nb">read </span>SERVEUR_DISTANT
  <span class="k">do 
    </span><span class="nv">BOUCLE_COURRANTE</span><span class="o">=</span><span class="sb">`</span><span class="nb">expr</span> <span class="k">${</span><span class="nv">BOUCLE_COURRANTE</span><span class="k">}</span> + 1<span class="sb">`</span>
    <span class="nb">echo</span> <span class="s2">"INFO -- </span><span class="k">${</span><span class="nv">SERVEUR_DISTANT</span><span class="k">}</span><span class="s2"> : </span><span class="k">${</span><span class="nv">BOUCLE_COURRANTE</span><span class="k">}</span><span class="s2">/</span><span class="k">${</span><span class="nv">NB_SERVEURS</span><span class="k">}</span><span class="s2">"</span>
    
    <span class="c"># on continue dans la boucle si le ping ne fonctionne pas</span>
    ping <span class="nt">-c</span> 1 <span class="k">${</span><span class="nv">SERVEUR_DISTANT</span><span class="k">}</span> <span class="o">&gt;</span> /dev/null  2&gt;&amp;1
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> <span class="nt">-ne</span> 0 <span class="o">]</span><span class="p">;</span><span class="k">then
      </span><span class="nb">echo</span> <span class="s2">"ERROR -- PING serveur </span><span class="k">${</span><span class="nv">SERVEUR_DISTANT</span><span class="k">}</span><span class="s2">"</span>
      <span class="nv">CR</span><span class="o">=</span>10
      <span class="k">continue
    fi</span>
    
    <span class="c"># ssh -n dans une boucle while sinon on sort de la boucle à la première occurence</span>
    <span class="c"># on continue si le ssh/scp ne fonctionne pas</span>
    scp <span class="k">${</span><span class="nv">FIC_SUBSCRIPT</span><span class="k">}</span>  <span class="k">${</span><span class="nv">SERVEUR_DISTANT</span><span class="k">}</span>:/var/tmp/ <span class="o">&gt;</span> /dev/null
    ssh <span class="nt">-n</span> <span class="k">${</span><span class="nv">SERVEUR_DISTANT</span><span class="k">}</span> <span class="s2">"chmod 777 /var/tmp/</span><span class="sb">`</span><span class="nb">basename</span> <span class="k">${</span><span class="nv">FIC_SUBSCRIPT</span><span class="k">}</span><span class="sb">`</span><span class="s2">"</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> <span class="nt">-ne</span> 0 <span class="o">]</span><span class="p">;</span><span class="k">then
      </span><span class="nb">echo</span> <span class="s2">"ERROR -- SSH serveur </span><span class="k">${</span><span class="nv">SERVEUR_DISTANT</span><span class="k">}</span><span class="s2">"</span>
      <span class="nv">CR</span><span class="o">=</span>11
      <span class="k">continue
    fi

    </span>ssh <span class="nt">-n</span> <span class="k">${</span><span class="nv">SERVEUR_DISTANT</span><span class="k">}</span> <span class="s2">"/var/tmp/</span><span class="sb">`</span><span class="nb">basename</span> <span class="k">${</span><span class="nv">FIC_SUBSCRIPT</span><span class="k">}</span><span class="sb">`</span><span class="s2">"</span> <span class="o">&gt;&gt;</span> <span class="k">${</span><span class="nv">FIC_SORTIE_EXT_CRONTAB</span><span class="k">}</span>

  <span class="k">done</span> &lt; <span class="k">${</span><span class="nv">FIC_LISTE_SERVEURS</span><span class="k">}</span>
<span class="k">fi

</span><span class="nb">exit</span> <span class="nv">$CR</span>
</code></pre></div></div>

<p>Pour déployer facilement un script depuis le serveur VTOM vers tous les clients, on peut aussi utiliser le <code class="language-plaintext highlighter-rouge">vtcopy</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vtmachine | grep -i running | awk -F"|" 'BEGIN{printf "tremote /machine="}{gsub(/[ 	]/, "", $2); printf "%s,",$2;}END{printf " vtcopy -i monfic_source -o mon_rep_dest\n"}'
</code></pre></div></div>

<p>Version tâches planifiées Windows (filtre des tâches microsoft) schtasks /query :</p>

<div class="language-batch highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@echo <span class="na">off</span>
<span class="kd">set</span> <span class="kd">USER</span><span class="o">=</span><span class="kd">administrateur</span>
<span class="kd">set</span> <span class="kd">PASSWD</span><span class="o">=</span><span class="kd">motdepasse</span>
<span class="k">for</span> <span class="na">/F </span><span class="vm">%i</span> <span class="k">in</span> <span class="o">(</span><span class="kd">c</span>:\temp\liste_client_windows.txt<span class="o">)</span> <span class="k">do</span> <span class="o">(</span>
<span class="nb">schtasks</span> <span class="na">/Query /FO </span><span class="kd">CSV</span> <span class="na">/V /S </span><span class="vm">%i</span> <span class="na">/U </span><span class="nv">%USER%</span> <span class="na">/P </span><span class="nv">%PASSWD%</span> <span class="o">|</span> <span class="nb">findstr</span> <span class="na">/V </span><span class="s2">"\Microsoft"</span> <span class="o">|</span> <span class="nb">findstr</span> <span class="na">/V </span><span class="s1">'"HostName","TaskName","Next Run Time","Status","Logon Mode","Last Run Time","Last Result","Author","Task To Run","Start In","Comment"'</span> 
<span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">c</span>:\temp\taches_planifiees_windows.csv
@echo <span class="na">on</span>
</code></pre></div></div>
</p>
      
    </div>

  </li>
  
  
  
  <li>
    <div class="card">
      <h4><a class="post-link" href="/archives/vtom-compter-nombre-traitements-par-machine/">Compter le nombre de traitements VTOM par client</a></h4>
      <p><p>Comment compter le nombre de traitements par client VTOM ?</p>

<p>Rien de bien sorcier :</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#on liste tous les jobs et on redirige dans un fichier temporaire</span>
tlist <span class="nb">jobs</span> <span class="o">&gt;</span> /var/tmp/tlistjobs

<span class="c">#on compte le nombre de lignes trouvées dans le fichier tlistjobs pour chaque client</span>
tlist machine | <span class="k">while </span><span class="nb">read </span>machine
<span class="k">do
</span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="nv">$machine</span><span class="s2">;"</span>
<span class="nv">nbJobs</span><span class="o">=</span><span class="sb">`</span><span class="nb">grep</span> <span class="nv">$machine</span> /var/tmp/tlistjobs | <span class="nb">wc</span> <span class="nt">-l</span><span class="sb">`</span>
<span class="nb">echo</span> <span class="nt">-en</span> <span class="s2">"</span><span class="nv">$nbJobs</span><span class="se">\n</span><span class="s2">"</span>
<span class="k">done</span>
</code></pre></div></div>
</p>
      
    </div>

  </li>
  
  
  
  <li>
    <div class="card">
      <h4><a class="post-link" href="/archives/ajax-list-directory-github/">Lister le contenu d'un répertoire Github en ajax</a></h4>
      <p><h1 id="but-du-jeu">But du jeu</h1>
<ul>
  <li>Héberger un site de photographies sur les <a href="https://pages.github.com/">pages Github</a></li>
  <li>Le site doit pouvoir récupérer dynamiquement les images push sur Github</li>
</ul>

<h1 id="démo">Démo</h1>
<p><a href="http://laure-photographies.github.io">Laure Photographies</a></p>

<h1 id="structure-du-site">Structure du site</h1>
<ul>
  <li>img
    <ul>
      <li>&lt;prefix&gt;&lt;nom d’un répertoire menu images&gt;</li>
      <li>img_dyptique (dyptique sera un menu)
        <ul>
          <li>image1.jpg</li>
          <li>image2.jpg</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h1 id="méthode--ajax-et-api-github">Méthode : ajax et API Github</h1>
<p>Le principe est simple : il faut récupérer les informations du repository via l’API Github en ajax. 
Pas d’authentification, c’est juste du GET.</p>

<p>Les API Github :</p>

<ul>
  <li><a href="https://developer.github.com/v3/repos">repos</a></li>
  <li>
    <p><a href="https://developer.github.com/v3/git/trees">trees</a></p>
  </li>
  <li>Récupérer le dernier commit du repository (son sha)</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">.</span><span class="nf">ajax</span><span class="p">({</span>
 <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://api.github.com/repos/laure-photographies/laure-photographies.github.io/branches</span><span class="dl">"</span><span class="p">,</span>
 <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
  <span class="c1">// récupération du dernier sha last commit du repos</span>
  <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">commit</span><span class="p">.</span><span class="nx">sha</span><span class="p">)</span> <span class="p">;</span>
 <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<ul>
  <li>Lister le contenu du répertoire img/ où se trouve les répertoires préfixés qui constitueront les menus</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">.</span><span class="nf">ajax</span><span class="p">({</span>
 <span class="c1">// github_repo_sha qu'on a récupéré dans l'appel ajax précédant</span>
 <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://api.github.com/repos/laure-photographies/laure-photographies.github.io/git/trees/</span><span class="dl">"</span><span class="o">+</span><span class="nx">github_repo_sha</span><span class="p">,</span>
 <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
  
  <span class="c1">// Récupération du sha du dossier img</span>
  <span class="nx">$</span><span class="p">.</span><span class="nf">each</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">tree</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
   <span class="k">if</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">path</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">img</span><span class="dl">"</span><span class="p">){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">sha</span><span class="p">);</span>
   <span class="p">}</span>
  <span class="p">});</span>
 <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<ul>
  <li>Lister les images du menu</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">.</span><span class="nf">ajax</span><span class="p">({</span>
 <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://api.github.com/repos/laure-photographies/laure-photographies.github.io/git/trees/</span><span class="dl">"</span><span class="o">+</span><span class="nx">img_sha</span><span class="p">,</span>
 <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
  <span class="c1">// data.tree array des items d'un menu</span>
  <span class="nx">$</span><span class="p">.</span><span class="nf">each</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">tree</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
   <span class="c1">// liste des noms des fichiers images</span>
   <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">path</span><span class="p">)</span> <span class="p">;</span>
  <span class="p">});</span>
 <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

</p>
      
    </div>

  </li>
  
  
  
  <li>
    <div class="card">
      <h4><a class="post-link" href="/archives/heberger-page-site-web-vthttpd-webacess-vtom/">Héberger une page web depuis vthttpd web access VTOM</a></h4>
      <p><p>Comment héberger une page ou un site web depuis votre service vthttpd web access VTOM ? en utilisant les alias :</p>

<h2 id="pré-requis">Pré-requis</h2>
<p>service WebAccess VTOM installé (vhttpd)</p>

<h2 id="configuration-du-webacces-vtom">Configuration du webacces VTOM</h2>
<p>Modifier le vthttpd.ini</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>httpAliases="/monsiteweb/=C:\VTOM5\WWW\monsiteweb\"
httpAllowedURI=/monsiteweb/*
</code></pre></div></div>

<p>Se rendre sur la page de votre webacces VTOM suivi de l’alias ex. <code class="language-plaintext highlighter-rouge">localhost:30080/monsiteweb/</code></p>
</p>
      
    </div>

  </li>
  
  
  
  <li>
    <div class="card">
      <h4><a class="post-link" href="/archives/sun-solaris-zones-clients-vtom-bdaemon/">Clients VTOM zones Solaris</a></h4>
      <p><p>Sur les superclusters Solaris, il ne faut pas faire un simple <code class="language-plaintext highlighter-rouge">ps -eaf | grep bdaemon</code> sous peine de voir tous les clients VTOM de toutes les zones (sortes de guest) du supercluster.</p>

<p>Le plus drôle arrive si on commence à kill les bdaemon des zones depuis le supercluster en croyant que c’était des bdaemons zombies, ça kill vraiment le client VTOM sur la zone.</p>

<p>C’est pourquoi il vaut mieux effectuer la commande <code class="language-plaintext highlighter-rouge">ps -flz global |  grep bdaemon</code> pour afficher les process du supercluster et, <code class="language-plaintext highlighter-rouge">ps -flZ | grep bdaemon</code> pour voir tous les clients et les zones associées.</p>

<p>Autres commandes pratiques pour voir les zones : 
<code class="language-plaintext highlighter-rouge">zoneadm list</code></p>

<p>Si global ==&gt; supercluster, si plusieurs lignes avec des hostnames, ce sont les zones du supercluster.</p>

<p>Si une seule ligne avec le hostname ==&gt; zone</p>
</p>
      
    </div>

  </li>
  
  
</ul>
<!-- Pagination links -->
<nav>
  <ul class="pagination">
    
    <li>
      <a href="/page9" class="Précédant">
        <span aria-hidden="true">&laquo;</span>
      </a>
    </li>
      
    <li>
      <a href="/archives/index.html">1</a>
    </li>
      
    <li>
      <a
        href="/archives/page2">2</a>
    </li>
      
    <li>
      <a
        href="/archives/page3">3</a>
    </li>
      
    <li>
      <a
        href="/archives/page4">4</a>
    </li>
      
    <li>
      <a
        href="/archives/page5">5</a>
    </li>
      
    <li>
      <a
        href="/archives/page6">6</a>
    </li>
      
    <li>
      <a
        href="/archives/page7">7</a>
    </li>
      
    <li>
      <a
        href="/archives/page8">8</a>
    </li>
      
    <li>
      <a
        href="/archives/page9">9</a>
    </li>
      
    <li class="active">
      <span>10</span>
    </li>
      
    <li>
      <a
        href="/archives/page11">11</a>
    </li>
      
    <li>
      <a
        href="/archives/page12">12</a>
    </li>
      
    <li>
      <a
        href="/archives/page13">13</a>
    </li>
      
    <li>
      <a
        href="/archives/page14">14</a>
    </li>
      
    <li>
      <a href="/page11" aria-label="Suivant">
        <span aria-hidden="true">&raquo;</span>
      </a>
    </li>
    
  </ul>
</nav>

      <footer id="site-footer">
    <div>&copy;<a href="https://github.com/virtual-thom/" title="Github Virtual-Thom">Virtual-Thom</a></div>
    <div>
            <a href="https://virtual-thom.github.io/archives/plan" title="Plan du site">sitemap</a> | <a href="https://virtual-thom.github.io/about" rel="publisher author" title="Curriculum vitae Thom">A propos</a>
    </div>
    <div>
        <a id="goto-site-header" href="#site-header" title="Retourner au début">&uArr; Top</a>
    </div>
    <div id="footer-disclaimer">
        <p>Avertissement : vous ne devez pas prendre pour argent comptant le contenu de ce site. Testez toujours la solution en environnement de test.</p>
        <p>Malgré le sérieux que je m'efforce de mettre dans le contenu de ces billets, je ne pourrai être tenu responsable d'éventuelles erreurs que cela pourrait engendrer.</p>
    </div>
    <div>
        <a class="hidden" href="https://virtual-thom.github.io/archives/sitemap.xml" title="SiteMap">sitemap</a>
    </div>
</footer>

    </div>
  </body>

</html>